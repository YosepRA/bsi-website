{"version":3,"file":"index.js","mappings":"mBAAwBA,SAASC,cAAc,uBACrBD,SAASC,cAAc,yBACzBD,SAASC,cAAc,uBC+C/C,QAjDA,MACEC,YAAYC,EAAkB,SAAUC,EAAU,UAChDC,KAAKC,MAAO,EACZD,KAAKE,KAAO,KACZF,KAAKF,gBAAkBA,EACvBE,KAAKD,QAAUA,CACjB,CAEAI,OAAOD,EAAME,EAAc,UACzB,IAAKJ,KAAKC,KAIR,YAHeN,SAASC,cAAc,IAAIQ,KACnCC,SAKT,MAAMC,EAASX,SAASY,cAAc,OAChCC,EAAgBb,SAASY,cAAc,OAE7CD,EAAOG,UAAUC,IAAI,SAAUN,GAC/BI,EAAcC,UAAUC,IAAI,mBAC5BF,EAAcG,iBAAiB,SAAS,KACtCX,KAAKY,YAAY,KAAMZ,KAAKF,iBAC5BE,KAAKD,SAAS,IAGhBO,EAAOO,YAAYL,GACnBF,EAAOO,YAAYX,GAEnBP,SAASmB,KAAKD,YAAYP,EAG5B,CAEAS,WAAWb,EAAME,GACfJ,KAAKC,MAAO,EACZD,KAAKE,KAAOA,EAEZF,KAAKG,OAAOD,EAAME,EACpB,CAEAQ,YAAYV,EAAME,GAChBJ,KAAKC,MAAO,EACZD,KAAKE,KAAO,KAEZF,KAAKG,OAAOD,EAAME,EACpB,GCNF,EAtCA,cAAuC,EACrCP,YAAYC,GACVkB,MAAMlB,EACR,CAEAmB,oBACEjB,KAAKY,YAAY,KAAMZ,KAAKF,gBAC9B,CAEAoB,mBAEE,MAAMC,EAAexB,SAASY,cAAc,OAC5CY,EAAaV,UAAUC,IAAI,kBAG3B,MAAMI,EAAOnB,SAASY,cAAc,OAC9Ba,EAAkBzB,SAASY,cAAc,UAO/Ca,EAAgBX,UAAUC,IAAI,sBAC9BU,EAAgBC,UAAY,oCAC5BD,EAAgBT,iBAAiB,SAAS,IAAMX,KAAKiB,sBAErDH,EAAKL,UAAUC,IAAI,gBACnBI,EAAKO,UAXe,6NAYpBP,EAAKD,YAAYO,GAGjBD,EAAaN,YAAYC,GAEzBd,KAAKe,WAAWI,EAAcnB,KAAKF,gBACrC,GCrCF,IAAewB,ECWA3B,SAASC,cAAc,WACfD,SAASC,cAAc,ODZ/B0B,ECcfC,iBAoBMC,OAAOC,SAASC,SAASC,MAFL,oBAGW,IAAI,EACnC,gCAGuBT,kBAE7B,EDxC8B,YAAxBvB,SAASiC,WACXN,IAEA3B,SAASgB,iBAAiB,mBAAoBW,E","sources":["webpack://bsi-web-client/./src/js/live-price.js","webpack://bsi-web-client/./src/js/dialogs/dialog.js","webpack://bsi-web-client/./src/js/dialogs/dream-concert-poster-dialog.js","webpack://bsi-web-client/./src/js/helpers.js","webpack://bsi-web-client/./src/js/index.js"],"sourcesContent":["const navbarPriceData = document.querySelector('.navbar__price-data');\r\nconst navbarPriceChange = document.querySelector('.navbar__price-change');\r\nconst navbarPriceTime = document.querySelector('.navbar__price-time');\r\n\r\nasync function fetchLatestPrice() {\r\n  const baseUrl = '/api/v1';\r\n\r\n  const data = await fetch(`${baseUrl}/price`).then((res) => res.json());\r\n\r\n  return data;\r\n}\r\n\r\nasync function updatePriceData(data) {\r\n  // const data = await fetchLatestPrice();\r\n  const priceText = `$${data.price}`;\r\n  const changeText = `${data.change24Hr > 0 ? '+' : ''}${\r\n    Math.round(data.change24Hr * 100) / 100\r\n  }%`;\r\n  const timeText = new Date(data.lastUpdatedAt).toLocaleString();\r\n\r\n  navbarPriceData.textContent = priceText;\r\n  navbarPriceChange.textContent = changeText;\r\n  navbarPriceTime.textContent = timeText;\r\n\r\n  // Toggle 24 hour change text color.\r\n  if (data.change24Hr > 0) {\r\n    navbarPriceChange.classList.add('navbar__price-change--up');\r\n    navbarPriceChange.classList.remove('navbar__price-change--down');\r\n  } else {\r\n    navbarPriceChange.classList.add('navbar__price-change--down');\r\n    navbarPriceChange.classList.remove('navbar__price-change--up');\r\n  }\r\n}\r\n\r\nfunction fetchPriceOnInterval(delay) {\r\n  setInterval(async () => {\r\n    const data = await fetchLatestPrice(data);\r\n\r\n    updatePriceData(data);\r\n  }, delay);\r\n}\r\n\r\nexport { fetchLatestPrice, fetchPriceOnInterval, updatePriceData };\r\n","class Dialog {\n  constructor(dialogClassName = 'dialog', cleanFn = () => {}) {\n    this.show = false;\n    this.node = null; // Full node.\n    this.dialogClassName = dialogClassName;\n    this.cleanFn = cleanFn;\n  }\n\n  render(node, dialogClass = 'dialog') {\n    if (!this.show) {\n      const dialog = document.querySelector(`.${dialogClass}`);\n      dialog.remove();\n\n      return undefined;\n    }\n\n    const dialog = document.createElement('div');\n    const dialogOverlay = document.createElement('div');\n\n    dialog.classList.add('dialog', dialogClass);\n    dialogOverlay.classList.add('dialog__overlay');\n    dialogOverlay.addEventListener('click', () => {\n      this.closeDialog(null, this.dialogClassName);\n      this.cleanFn();\n    });\n\n    dialog.appendChild(dialogOverlay);\n    dialog.appendChild(node);\n\n    document.body.appendChild(dialog);\n\n    return undefined;\n  }\n\n  showDialog(node, dialogClass) {\n    this.show = true;\n    this.node = node;\n\n    this.render(node, dialogClass);\n  }\n\n  closeDialog(node, dialogClass) {\n    this.show = false;\n    this.node = null;\n\n    this.render(node, dialogClass);\n  }\n}\n\nexport default Dialog;\n","import Dialog from './dialog.js';\r\n\r\nclass DreamConcertPosterDialog extends Dialog {\r\n  constructor(dialogClassName) {\r\n    super(dialogClassName);\r\n  }\r\n\r\n  closePosterDialog() {\r\n    this.closeDialog(null, this.dialogClassName);\r\n  }\r\n\r\n  showPosterDialog() {\r\n    // Dialog window.\r\n    const dialogWindow = document.createElement('div');\r\n    dialogWindow.classList.add('dialog__window');\r\n\r\n    // Dialog body.\r\n    const body = document.createElement('div');\r\n    const bodyCloseButton = document.createElement('button');\r\n    const bodyContent = `\r\n      <a href=\"/en/bsi-dream-concert-event\" target=\"_blank\" rel=\"noreferrer\">\r\n        <img src=\"/img/dream-concert-poster.png\" alt=\"29th Dream Concert with Digifinex\" class=\"dialog__body-poster\" />\r\n      </a>\r\n    `;\r\n\r\n    bodyCloseButton.classList.add('dialog__body-close');\r\n    bodyCloseButton.innerHTML = '<i class=\"fa-solid fa-xmark\"></i>';\r\n    bodyCloseButton.addEventListener('click', () => this.closePosterDialog());\r\n\r\n    body.classList.add('dialog__body');\r\n    body.innerHTML = bodyContent;\r\n    body.appendChild(bodyCloseButton);\r\n\r\n    // Show dialog.\r\n    dialogWindow.appendChild(body);\r\n\r\n    this.showDialog(dialogWindow, this.dialogClassName);\r\n  }\r\n}\r\n\r\nexport default DreamConcertPosterDialog;\r\n","function ready(fn) {\r\n  if (document.readyState !== 'loading') {\r\n    fn();\r\n  } else {\r\n    document.addEventListener('DOMContentLoaded', fn);\r\n  }\r\n}\r\n\r\nfunction throttle(fn, delay) {\r\n  let prev = Date.now();\r\n\r\n  return function throttleFunction() {\r\n    const now = Date.now();\r\n\r\n    if (now - prev > delay) {\r\n      fn();\r\n\r\n      prev = now;\r\n    }\r\n  };\r\n}\r\n\r\nasync function promiseResolver(promise) {\r\n  try {\r\n    const data = await promise;\r\n    return [data, null];\r\n  } catch (err) {\r\n    return [null, err];\r\n  }\r\n}\r\n\r\nexport { ready, throttle, promiseResolver };\r\n","import { ready } from './helpers.js';\r\nimport ScrollControl from './scroll-control.js';\r\nimport { navbarScroll, floatingButtonScroll } from './scroll-behaviors.js';\r\nimport {\r\n  fetchLatestPrice,\r\n  updatePriceData,\r\n  fetchPriceOnInterval,\r\n} from './live-price.js';\r\n// import startSocket from './socket.js';\r\nimport DreamConcertPosterDialog from './dialogs/dream-concert-poster-dialog.js';\r\n\r\nconst navbar = document.querySelector('.navbar');\r\nconst floatingButton = document.querySelector('.fb');\r\n\r\nasync function start() {\r\n  // Scroll feature.\r\n  // const scroll = new ScrollControl([\r\n  //   navbarScroll(navbar),\r\n  //   floatingButtonScroll(floatingButton),\r\n  // ]);\r\n\r\n  // Live price feature.\r\n  // const data = await fetchLatestPrice();\r\n  // const delay = 120000;\r\n  // await updatePriceData(data);\r\n  // fetchPriceOnInterval(delay);\r\n\r\n  // Socket will be disabled on Demo server, or Cyclic.sh server.\r\n  // startSocket();\r\n\r\n  // Dream Concert poster popup.\r\n  // Only show in home page.\r\n  const homePathPattern = /^\\/\\w{2}\\/home$/;\r\n\r\n  if (window.location.pathname.match(homePathPattern)) {\r\n    const dreamConcertPosterDialog = new DreamConcertPosterDialog(\r\n      'dialog--dream-concert-poster',\r\n    );\r\n\r\n    dreamConcertPosterDialog.showPosterDialog();\r\n  }\r\n}\r\n\r\nready(start);\r\n"],"names":["document","querySelector","constructor","dialogClassName","cleanFn","this","show","node","render","dialogClass","remove","dialog","createElement","dialogOverlay","classList","add","addEventListener","closeDialog","appendChild","body","showDialog","super","closePosterDialog","showPosterDialog","dialogWindow","bodyCloseButton","innerHTML","fn","async","window","location","pathname","match","readyState"],"sourceRoot":""}